<!-- templates/event-detail.html -->

{% extends "base.html" %}

{% block content %}
<div class="container-fluid mt-4">
    <!-- Error Handling -->
    {% if error %}
        <div class="alert alert-danger text-center" role="alert">
            {{ error }}
        </div>
    {% else %}
        <!-- Event Details Card -->
        <div class="card shadow-lg p-4">
            <div class="card-header bg-info text-white d-flex justify-content-between align-items-center">
                <h4 class="mb-0">Event: {{ event.metadata.name }}</h4>
                <a href="{% url 'all_events_page' %}" class="btn btn-light btn-sm">Back to Events</a>
            </div>
            <div class="card-body">
                <!-- Event Details Table -->
                <table class="table table-striped table-bordered">
                    <tbody>
                        <tr>
                            <th scope="row">Event Name</th>
                            <td>{{ event.metadata.name }}</td>
                        </tr>
                        <tr>
                            <th scope="row">Involved Object Name</th>
                            <td>{{ event.involved_object.name }}</td>
                        </tr>
                        <tr>
                            <th scope="row">Namespace</th>
                            <td>{{ event.metadata.namespace }}</td>
                        </tr>
                        <tr>
                            <th scope="row">Kind</th>
                            <td>{{ event.involved_object.kind }}</td>
                        </tr>
                        <tr>
                            <th scope="row">Type</th>
                            <td>
                                {% if event.type == 'Normal' %}
                                    <span class="badge bg-success">{{ event.type }}</span>
                                {% elif event.type == 'Warning' %}
                                    <span class="badge bg-warning text-dark">{{ event.type }}</span>
                                {% else %}
                                    {{ event.type }}
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <th scope="row">Reason</th>
                            <td>{{ event.reason }}</td>
                        </tr>
                        <tr>
                            <th scope="row">Message</th>
                            <td>{{ event.message }}</td>
                        </tr>
                        <tr>
                            <th scope="row">Count</th>
                            <td>{{ event.count }}</td>
                        </tr>
                        <tr>
                            <th scope="row">Source Component</th>
                            <td>{{ event.source.component }}</td>
                        </tr>
                        <tr>
                            <th scope="row">Source Host</th>
                            <td>{{ event.source.host }}</td>
                        </tr>
                        <tr>
                            <th scope="row">First Seen</th>
                            <td>
                                {% if event.first_timestamp %}
                                    {{ event.first_timestamp|date:"Y-m-d H:i:s" }}
                                {% else %}
                                    N/A
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <th scope="row">Last Seen</th>
                            <td>
                                {% if event.last_timestamp %}
                                    {{ event.last_timestamp|date:"Y-m-d H:i:s" }}
                                {% else %}
                                    N/A
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <th scope="row">Involved Object</th>
                            <td>
                                <strong>Kind:</strong> {{ event.involved_object.kind }}<br>
                                <strong>Name:</strong>
                                {% if event.involved_object.kind == 'Pod' %}
                                    <a href="{% url 'pod_details_page' event.involved_object.namespace event.involved_object.name %}" target="_blank">
                                        {{ event.involved_object.name }}
                                    </a><br>
                                {% else %}
                                    {{ event.involved_object.name }}<br>
                                {% endif %}
                                <strong>Namespace:</strong> {{ event.involved_object.namespace }}
                            </td>
                        </tr>
                        <tr>
                            <th scope="row">Metadata</th>
                            <td>
                                <strong>UID:</strong> {{ event.metadata.uid }}<br>
                                <strong>Resource Version:</strong> {{ event.metadata.resource_version }}<br>
                                <strong>Creation Timestamp:</strong>
                                {{ event.metadata.creation_timestamp|date:"Y-m-d H:i:s" }}
                            </td>
                        </tr>
                        <tr>
                            <th scope="row">Additional Information</th>
                            <td>
                                {% if additional_properties %}
                                    <ul>
                                        {% for key, value in additional_properties.items %}
                                            <li><strong>{{ key }}:</strong> {{ value }}</li>
                                        {% endfor %}
                                    </ul>
                                {% else %}
                                    N/A
                                {% endif %}
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    {% endif %}
</div>
{% endblock %}