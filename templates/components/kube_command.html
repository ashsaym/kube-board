<!-- Existing container div -->
<div class="command-container">
    {% if display_type == 'pre' or display_type == 'pre_icon' %}
        <pre><code>{{ kube_command }}</code></pre>
    {% endif %}

    {% if display_type == 'icon' or display_type == 'pre_icon' %}
        <button class="copy-command btn btn-outline-light btn-sm" data-command="{{ kube_command }}"
                title="Copy Command to Clipboard">
            <i class="bi bi-clipboard"></i>
        </button>
    {% endif %}
</div>

<!-- Additional styles for copy command buttons and layout -->
<style>
    /* Flex container to align items horizontally */
    .command-container {
        display: flex;
        align-items: center;
    }

    /* Style for the <pre> element */
    .command-container pre {
        background-color: #000;
        color: #fff;
        padding: 10px;
        border-radius: 5px;
        overflow-x: auto;
        margin: 0; /* Remove default margins to align properly */
        flex: 1; /* Allow <pre> to take up remaining space */
        font-size: 0.9rem; /* Optional: Adjust font size */
        white-space: pre-wrap; /* Optional: Allow long commands to wrap */
    }

    /* Style for the copy button */
    .copy-command {
        background-color: transparent;
        border: none;
        color: #fff;
        cursor: pointer;
        font-size: 1.2rem;
        margin-left: 10px; /* Space between <pre> and button */
        transition: color 0.3s;
        padding: 5px; /* Increase clickable area */
    }

    .copy-command:hover {
        color: #d1d1d1;
    }

    .copy-command:focus {
        outline: none;
        box-shadow: none;
    }

    /* Prevent icon from being affected by button styles */
    .copy-command i {
        pointer-events: none;
    }

    /* Optional: Ensure code uses a monospace font */
    code {
        font-family: monospace;
    }
</style>

<!-- JavaScript for Copy Functionality -->
<script>
    document.addEventListener("DOMContentLoaded", function () {

        // Copy Command Functionality
        function handleCopyCommand(event) {
            const button = event.currentTarget;
            const command = button.getAttribute('data-command');
            if (!command) return;

            navigator.clipboard.writeText(command)
                .then(() => {
                    // Provide visual feedback by changing the icon
                    button.innerHTML = '<i class="bi bi-clipboard-check"></i>';

                    // Revert back to the original icon after 2 seconds
                    setTimeout(() => {
                        button.innerHTML = '<i class="bi bi-clipboard"></i>';
                    }, 2000);
                })
                .catch(err => {
                    console.error("Failed to copy command: ", err);
                    // Optional: Display an error message to the user
                });
        }

        // Attach event listeners to all copy-command buttons
        const copyButtons = document.querySelectorAll('.copy-command');
        copyButtons.forEach(button => {
            button.addEventListener('click', handleCopyCommand);
        });
    });
</script>